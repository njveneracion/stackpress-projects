import { action } from '@stackpress/ingest/Server';
export default action(async function QueryScript(_req, res, ctx) {
    const cli = ctx.plugin('cli');
    const database = ctx.plugin('database');
    if (!database) {
        cli?.verbose && cli.control.error('No database found');
        res.setError('No database found');
        return;
    }
    const query = process.argv.slice(2).pop();
    if (query) {
        console.log(await database.query(query.replace(/\\/g, "'")));
    }
    res.setStatus(200);
});
