import { action } from '@stackpress/ingest/Server';
import migrate from '../../scripts/migrate.js';
export default action(async function MigrateScript(_req, res, ctx) {
    const cli = ctx.plugin('cli');
    const database = ctx.plugin('database');
    if (!database) {
        cli?.verbose && cli.control.error('No database found');
        res.setError('No database found');
        return;
    }
    cli?.verbose && cli.control.system('Creating migration file...');
    await migrate(ctx, database);
    cli?.verbose && cli.control.success('Migration file created.');
    res.setStatus(200);
});
