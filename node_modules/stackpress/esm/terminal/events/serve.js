import { action } from '@stackpress/ingest/Server';
import serve from '../../scripts/serve.js';
export default action(async function ServeScript(_req, res, ctx) {
    const cli = ctx.plugin('cli');
    const port = ctx.config.path('server.port', 3000);
    cli?.verbose && cli.control.system(`Server is running on port ${port}`);
    cli?.verbose && cli.control.system('------------------------------');
    const server = await serve(ctx, port);
    server.on('error', e => {
        cli?.verbose && cli.control.error(e.message);
    });
    server.on('close', () => {
        cli?.verbose && cli.control.success('Server Exited.');
    });
    res.setStatus(200);
});
