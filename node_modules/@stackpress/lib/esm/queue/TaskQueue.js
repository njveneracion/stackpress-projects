import Status from '../Status.js';
import ItemQueue from './ItemQueue.js';
export default class TaskQueue extends ItemQueue {
    _after;
    _before;
    set after(action) {
        this._after = action;
    }
    set before(action) {
        this._before = action;
    }
    async run(...args) {
        if (!this.queue.length) {
            return Status.NOT_FOUND;
        }
        while (this.queue.length) {
            const task = this.consume();
            if (this._before && await this._before(...args) === false) {
                return Status.ABORT;
            }
            if (task && await task(...args) === false) {
                return Status.ABORT;
            }
            if (this._after && await this._after(...args) === false) {
                return Status.ABORT;
            }
        }
        return Status.OK;
    }
}
