import { objectFromQuery } from '../helpers.js';
export const WhatwgRequest = global.Request;
export const WhatwgResponse = global.Response;
export function reqToURL(resource) {
    let url = new URL(resource.url);
    url.pathname = url.pathname.replaceAll('//', '/');
    if (url.pathname.endsWith('/')) {
        url.pathname = url.pathname.slice(0, -1);
    }
    return url;
}
;
export function reqQueryToObject(resource) {
    return objectFromQuery(reqToURL(resource).searchParams.toString());
}
;
export function readableToReadableStream(stream) {
    return new ReadableStream({
        start(controller) {
            stream.on('data', chunk => controller.enqueue(chunk));
            stream.on('end', () => controller.close());
        }
    });
}
;
